<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Outlock Base</title>
    <link rel="stylesheet" href="~/Modifi/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>
<body>
    <header>
        <div id="titulo">
            <button class="menu">
                <img id="imgMenu" src="~/Modifi/588a64e0d06f6719692a2d10.png" alt="" srcset="">
            </button>
            <img src="~/Modifi/logotec (weld).png">
            <div>
                <h1>MINUTAS</h1>
                <p>Luis Carlos Esteban Longares Vidal</p>
            </div>
        </div>
        <div id="seccion">
            <input type="search" placeholder="">
            <i id="buscar" class="material-icons">search</i>

        </div>
    </header>
    <div class="content">
        <aside class="sidebar">
            <a id="apartado-minutas" href="/Admin/Home">Minutas</a>
            <a id="apartado-empleados" href="/Admin/Empleado">Empleados</a>
            <a id="apartado-departamentos" href="/Admin/Departamento">Departamentos</a>
            <a id="apartado-perfil" href="/Admin/Perfil">Perfil</a>
            <a id="apartado-sesion" href="/Modifi/login.html">Cerrar Sesión</a>
            <a id="apartado-configuracion" href="/Admin/Configuracion" class="material-icons">settings</a>
        </aside>
        <main>
            <form id="perfil">
                <h3><span>#4455 </span>ADMINISTRADOR <span></h3>
                <div class="campos-container">
                    <div class="datos">
                        <label>Nombre</label>
                        <label>Correo Electrónico</label>
                        <label>Fecha de Nacimiento</label>
                        <label>Contraseña</label>
                    </div>
                    <div class="editables" data-section="perfil">
                        <div>
                            <input id="perfilNombre" type="text" value="Luis Carlos Longares Vidal" disabled>
                            <button data-input="perfilNombre" class="btnEditarPerfil editarbtns" title="Editar">🖉</button>
                            <button class="GuardarPerfil editarbtns">✔️</button>
                            <button class="CancelarPerfil editarbtns">❌</button>
                        </div>
                        <div>
                            <input id="perfilCorreo" type="text" value="lglv@rcarbonifera.tecnm.mx" disabled>
                            <button data-input="perfilCorreo" class="btnEditarPerfil editarbtns" title="Editar">🖉</button>
                            <button class="GuardarPerfil editarbtns">✔️</button>
                            <button class="CancelarPerfil editarbtns">❌</button>
                        </div>
                        <div>
                            <input id="perfilNacimiento" type="datetime" value="02/03/85" disabled>
                            <button disabled data-input="perfilNacimiento" class="btnEditarPerfil editarbtns" title="Editar">🖉</button>
                            <button class="GuardarPerfil editarbtns">✔️</button>
                            <button class="CancelarPerfil editarbtns">❌</button>
                        </div>
                        <div>
                            <input id="perfilContraseña" type="password" value="contraseña" disabled>
                            <button data-input="perfilContraseña" class="btnEditarPerfil editarbtns" title="Editar">🖉</button>
                            <button class="GuardarPerfil editarbtns">✔️</button>
                            <button class="CancelarPerfil editarbtns">❌</button>
                        </div>
                    </div>
                </div>
            </form>
        </main>
    </div>
    <script>
          const menu = document.querySelector('.menu');
          const sidebar = document.querySelector('.sidebar');
          const header =document.querySelector("header");

         inicializarEditables('[data-section="perfil"]');
         inicializarEditables('[data-section="correo"]');

         function inicializarEditables(sectionSelector) {
         const seccion = document.querySelector(sectionSelector);
         if (!seccion) return;

         const botonesEditar = seccion.querySelectorAll(".btnEditarPerfil");

         botonesEditar.forEach(btn => {
            btn.addEventListener("click", (e) => {
            e.preventDefault();
            const campoId = btn.dataset.input;

            // Deshabilitar todos los inputs de esta sección
            seccion.querySelectorAll("input, select").forEach(input => {
                input.disabled = true;
                input.classList.remove("active");
            });

            // Ocultar todos los botones de esta sección
            seccion.querySelectorAll(".GuardarPerfil, .CancelarPerfil").forEach(b => b.style.display = "none");
            seccion.querySelectorAll(".btnEditarPerfil").forEach(b => b.style.display = "inline");

            // Activar solo el campo correspondiente
            const campo = document.getElementById(campoId);
            campo.disabled = false;
            campo.classList.add("active");
            campo.focus();

            // Mostrar botones de guardar/cancelar solo para este campo
            const divPadre = btn.closest("div");
            btn.style.display = "none";
            divPadre.querySelector(".GuardarPerfil").style.display = "inline";
            divPadre.querySelector(".CancelarPerfil").style.display = "inline";
            });
            });
            }


          document.querySelector("#buscar").addEventListener("click",function (){
              header.classList.toggle("buscar");

          });

          // este es solo de MUESTRA al momento de usar el buscador
          const buscador = document.querySelector("#buscar");
          buscador.addEventListener("input", function(){
               if (buscador.value.length > 0) {
                  setTimeout(function(){
                      window.location.href = "index.html";
                  }, 1000);

              }
          })
          //Sidebar
          menu.addEventListener('click', () => {
              sidebar.classList.toggle('active');
          });


          const agregar = document.querySelector("#agregar");
          sidebar.addEventListener("click", function(e){
              if(e.target.tagName == "I"){
                  agregar.style.visibility="visible";
              }

          });

          //CambioEnMovilDeminuta
          const Lista=document.querySelector('.minutas-list');
          const minutasContent=document.querySelector('.minuta-content');
          const minutas=document.querySelector('.minutas');

          minutas.addEventListener('click',(e)=>{
              if(!e.target.classList.contains('filtros') && !e.target.parentElement.parentElement.classList.contains('filtros')  && !e.target.parentElement.classList.contains('filtros')){

                  minutasContent.classList.toggle('active');
                  console.log(e.target.parentElement.classList.contains('filtros'));
                  Lista.classList.toggle('inactive');
              }
          });


          history.pushState(null, "", location.href);

          window.addEventListener("popstate", function () {
              Lista.classList.toggle('inactive');
          console.log("Intento de salir con botón de retroceso");
          history.pushState(null, "", location.href); // Reagrega el estado para evitar la salida
          });


          document.addEventListener("click", function (event) {
        //      if (!minutasContent.contains(event.target) && !minutas.contains(event.target)) {
          //        minutasContent.classList.remove('active');
            //      minutas.classList.remove('inactive');
              //}
              if (!sidebar.contains(event.target ) && !menu.contains(event.target)) {
                  if (sidebar.classList.contains('active')) {
                      sidebar.classList.remove('active');
              console.log('click en sidebar');

                  }
              }
          });

          document.getElementById("btnfiltros").addEventListener("click", function (e) {
              const filtrar = document.querySelector(".filtrar");
              e.target.classList.toggle("active");
              filtrar.classList.toggle("active");
          });
    </script>
</body>
</html>